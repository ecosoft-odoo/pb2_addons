<?xml version="1.0" encoding="UTF-8"?>
<openerp>
	<data>
        <record id="view_report_budget_common_multi_form" model="ir.ui.view">
            <field name="name">view.report.budget.common.multi.form</field>
            <field name="model">report.budget.common.multi</field>
            <field name="inherit_id" ref="pabi_utils.xlsx_report_view"/>
            <field name="mode">primary</field>
            <field name="arch" type="xml">
	            <!-- <xpath expr="//form[@string='Excel Report']" position="inside">
	            	 <field name="action_type" invisible="1"/>
            	</xpath> -->
                <xpath expr="//group[@name='criteria']" position="replace">
                    <group name="report_types">
                        <group>
                            <field name="report_type" attrs="{'invisible': [('action_type', '=', 'my_budget_report')]}"/>
                            <field name="chart_view" attrs="{'invisible': [('action_type', 'not in', ('my_budget_report'))]}"/>
                            <field name="budget_method" attrs="{'invisible': ['|',('report_type', '=', ('personnel')),
                            												('action_type', 'not in', ('my_budget_report'))]}"/>
                        </group>
                        <group>
                            <field name="fiscalyear_id"/>
                        </group>
                    </group>
                    <group name="filter" string="Filter / Group By">
                        <group>
                            <!-- Action type -->
                            <field name="action_type" invisible="1"/>

                            # For menu budget overview report
                            <field name="chartfield_id" attrs="{'invisible': [('report_type', 'not in', ('all'))]}"/>
                            <field name="charge_type" attrs="{'invisible': [('report_type', 'not in', ('all', 'project_base', 'unit_base', 'invest_asset', 'invest_construction'))]}"/>
                            <field name="org_id" attrs="{'invisible': [('report_type', '=', False)]}"/>
                            <!-- filter unit_base -->
                            <field name="sector_id"  attrs="{'invisible': [('report_type', 'not in', ('all', 'project_base', 'unit_base', 'personnel', 'invest_asset', 'invest_construction'))]}"/>
                            <field name="subsector_id" attrs="{'invisible': [('report_type', 'not in', ('all', 'project_base', 'unit_base', 'personnel', 'invest_asset', 'invest_construction'))]}"/>
                            <field name="division_id" attrs="{'invisible': [('report_type', 'not in', ('all', 'project_base', 'unit_base', 'personnel', 'invest_asset', 'invest_construction'))]}"/>
                            <field name="section_id" attrs="{'invisible': [('report_type', 'not in', ('all', 'project_base', 'unit_base', 'invest_asset', 'invest_construction'))]}" context="{'active_test': False}"/>
                            <field name="section_program_id" attrs="{'invisible': [('report_type', 'not in', ('all', 'unit_base'))]}"/>
                            <!-- filter unit_base and invest_asset -->
                            <field name="invest_asset_id" attrs="{'invisible': [('report_type', 'not in', ('invest_asset'))]}"/>
                            <field name="activity_group_id" attrs="{'invisible': [('report_type', 'not in', ('unit_base', 'invest_asset'))]}"/>
                            <field name="activity_id" attrs="{'invisible': [ ('report_type', 'not in', ('unit_base', 'invest_asset'))]}"/>
                            <!-- filter project_base -->
                            <field name="functional_area_id" attrs="{'invisible': [('report_type', 'not in', ('project_base'))]}"/>
                            <field name="program_group_id" attrs="{'invisible': [('report_type', 'not in', ('project_base'))]}"/>
                            <field name="program_id" attrs="{'invisible': [('report_type', 'not in', ('project_base'))]}"/>
                            <field name="project_group_id" attrs="{'invisible': [('report_type', 'not in', ('project_base'))]}"/>
                            <field name="project_id" attrs="{'invisible': [('report_type', 'not in', ('project_base'))]}" context="{'active_test': False}"/>
                            <!-- filter invest_construction -->
                            <field name="invest_construction_id" attrs="{'invisible': [('report_type', 'not in', ('invest_construction'))]}"/>

                            # For menu my budget report
                            <field name="section_ids" widget="many2many_tags" attrs="{'invisible': [('report_type', 'not in', ('unit_base'))]}" context="{'active_test': False}"/>
                            <field name="project_ids" widget="many2many_tags" attrs="{'invisible': [('report_type', 'not in', ('project_base'))]}" context="{'active_test': False}"/>
                        </group>
                        <group>
                            <field name="group_by_chartfield_id" attrs="{'invisible': [('report_type', 'not in', ('all'))]}"/>
                            <field name="group_by_org_id" attrs="{'invisible': [('report_type', 'not in', ('invest_asset', 'invest_construction', 'personnel'))]}"/>
                            <field name="group_by_section_id"  attrs="{'invisible': [('report_type', 'not in', ('unit_base'))]}"/>
                            <field name="group_by_invest_construction_id" attrs="{'invisible': [('report_type', 'not in', ('invest_construction'))]}"/>
                            <field name="group_by_invest_construction_phase_id" attrs="{'invisible': [('report_type', 'not in', ('invest_construction'))]}"/>
                            <field name="group_by_project_id" attrs="{'invisible': [('report_type', 'not in', ('project_base'))]}"/>
                            <field name="group_by_charge_type" attrs="{'invisible': [('report_type', 'not in', ('unit_base', 'project_base'))]}"/>
                            <field name="group_by_personnel_costcenter_id" attrs="{'invisible': [('report_type', 'not in', ('personnel'))]}"/>
                            <field name="group_by_activity_group_id" attrs="{'invisible': [('report_type', 'not in', ('unit_base', 'project_base', 'personnel'))]}"/>
                            <field name="group_by_activity_id" attrs="{'invisible': [('report_type', 'not in', ('unit_base', 'project_base', 'personnel'))]}"/>
                            <field name="group_by_invest_asset_id" attrs="{'invisible': [('report_type', 'not in', ('invest_asset'))]}"/>
                            <field name="group_by_budget_method" attrs="{'invisible': [('report_type', 'not in', ('unit_base', 'project_base'))]}"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Budget Filters" name="budget_filters">
                            <group>
                                <group string="Paste list of code to search">
                                    <field name="line_filter" placeholder="Paste list of Budget Costcenter" nolabel="1" context="{'active_test': False}"  />
                                </group>
                                <group string="Print only">
                                    <field name="chartfield_ids" nolabel="1" />
                                </group>
                            </group>
                        </page>
                    </notebook>
                </xpath>
                <xpath expr="//div[@name='xlsx.report']" position="before">
                	<group name="report_type" string="Report type">
	                	<div states="choose">   <!-- groups="pabi_utils.group_see_own_spool_report"> --> 
							<field name="xlsx_report" on_change="1" /><label for="xlsx_report"/>
							<field name="analytic_report" on_change="1" /><label for="analytic_report"/>
							<field name="jasper_report" on_change="1" /><label for="jasper_report"/>
						</div>
                    </group>
                </xpath>
                <xpath expr="//div[@name='xlsx.report']" position="replace">
                	<div name="xlsx.report" attrs="{'invisible': [('xlsx_report', '!=', True)]}" >
					    <field name="state" invisible="1"/>
					    <field name="name" invisible="1"/>
					    <div states="choose" groups="pabi_utils.group_see_own_spool_report">
					        <field name="async_process"/>
					        	<label for="async_process"/>
					        <field name="to_csv" /><label for="to_csv" />
					        <field name="csv_delimiter" invisible="1"/>
					        <field name="csv_extension" invisible="1"/>
					        <field name="csv_quote" invisible="1"/>
					    </div>
					    <div states="get">
					        <h2 attrs="{'invisible': [('async_process', '=', True)]}">
					            Complete Prepare Report (.xlsx)
					        </h2>
					        <h2 attrs="{'invisible': [('async_process', '=', False)]}">
					            Report Enqueued (.xlsx)
					        </h2>
					        <p attrs="{'invisible': [('async_process', '=', True)]}" colspan="4">
					            Here is the report file:
					            <field name="data" filename="name" class="oe_inline"/>
					        </p>
					        <p attrs="{'invisible': [('async_process', '=', False)]}" colspan="4">
					            Report UUID:
					            <field name="uuid" class="oe_inline"/>
					        </p>
					    </div>
					</div>
                </xpath>
                <xpath expr="//div[@name='xlsx.report']" position="after">
                	<footer name="button_report" states="choose">
					    <button name="action_get_report" string="Execute Report" type="object" class="oe_highlight"
                				attrs="{'invisible': [('xlsx_report', '!=', True)]}" />
	                	<button name="run_report" string="View Report" type="object" default_focus="1" class="oe_highlight" 
							    attrs="{'invisible': [('analytic_report', '!=', True)]}" />
		                <button name="run_jasper_report" string="View Report" type="object" default_focus="1" class="oe_highlight"
							    attrs="{'invisible': [('jasper_report', '!=', True)]}"/>
					    or
					    <button special="cancel" string="Cancel" type="object" class="oe_link"/>
					</footer>
					<footer states="get">
					    <button special="cancel" string="Close" type="object"/>
					</footer>
                </xpath>
            </field>
        </record>
        
        <record model="ir.ui.view" id="view_budget_common_multi_drilldown_form">
            <field name="name">view.budget.common.drilldown.form</field>
            <field name="model">report.budget.common.multi</field>
            <field name="arch" type="xml">
                <form string="Budget Overview Report" edit="0" create="0" delete="0">
                    <h1>
                        <field name="name"/>
                    </h1>
                    <group name="report_type">
                        <group>
                            <field name="report_type"/>
                        </group>
                        <group>
                            <field name="fiscalyear_id"/>
                        </group>
                    </group>
                    <group name="filter" string="Filter / Group By">
                        <group>
                            <!-- Action type -->
                            <field name="action_type" invisible="1"/>

                            # For menu budget overview report
                            <field name="chartfield_id" attrs="{'invisible': ['|', ('action_type', '!=', 'budget_overview_report'), ('report_type', 'not in', ('all'))]}"/>
                            <field name="charge_type" attrs="{'invisible': ['|', ('action_type', '!=', 'budget_overview_report'), ('report_type', 'not in', ('all', 'project_base', 'unit_base', 'invest_asset', 'invest_construction'))]}"/>
                            <field name="org_id" attrs="{'invisible': ['|', ('action_type', '!=', 'budget_overview_report'), ('report_type', '=', False)]}"/>
                            <field name="sector_id"  attrs="{'invisible': ['|', ('action_type', '!=', 'budget_overview_report'), ('report_type', 'not in', ('all', 'project_base', 'unit_base', 'personnel', 'invest_asset', 'invest_construction'))]}"/>
                            <field name="subsector_id" attrs="{'invisible': ['|', ('action_type', '!=', 'budget_overview_report'), ('report_type', 'not in', ('all', 'project_base', 'unit_base', 'personnel', 'invest_asset', 'invest_construction'))]}"/>
                            <field name="division_id" attrs="{'invisible': ['|', ('action_type', '!=', 'budget_overview_report'), ('report_type', 'not in', ('all', 'project_base', 'unit_base', 'personnel', 'invest_asset', 'invest_construction'))]}"/>
                            <field name="section_id" attrs="{'invisible': ['|', ('action_type', '!=', 'budget_overview_report'), ('report_type', 'not in', ('all', 'project_base', 'unit_base', 'invest_asset', 'invest_construction'))]}"/>
                            <field name="section_program_id" attrs="{'invisible': ['|', ('action_type', '!=', 'budget_overview_report'), ('report_type', 'not in', ('all', 'unit_base'))]}"/>
                            <field name="budget_method" attrs="{'invisible': ['|', ('action_type', '!=', 'budget_overview_report'), ('report_type', '=', ('personnel'))]}"/>
                            <!-- unit_base and invest_asset -->
                            <field name="invest_asset_id" attrs="{'invisible': ['|', ('action_type', '!=', 'budget_overview_report'), ('report_type', 'not in', ('invest_asset'))]}"/>
                            <field name="activity_group_id" attrs="{'invisible': ['|', ('action_type', '!=', 'budget_overview_report'), ('report_type', 'not in', ('unit_base', 'invest_asset'))]}"/>
                            <field name="activity_id" attrs="{'invisible': ['|', ('action_type', '!=', 'budget_overview_report'), ('report_type', 'not in', ('unit_base', 'invest_asset'))]}"/>
                            <!-- project_base -->
                            <field name="functional_area_id" attrs="{'invisible': ['|', ('action_type', '!=', 'budget_overview_report'), ('report_type', 'not in', ('project_base'))]}"/>
                            <field name="program_group_id" attrs="{'invisible': ['|', ('action_type', '!=', 'budget_overview_report'), ('report_type', 'not in', ('project_base'))]}"/>
                            <field name="program_id" attrs="{'invisible': ['|', ('action_type', '!=', 'budget_overview_report'), ('report_type', 'not in', ('project_base'))]}"/>
                            <field name="project_group_id" attrs="{'invisible': ['|', ('action_type', '!=', 'budget_overview_report'), ('report_type', 'not in', ('project_base'))]}"/>
                            <field name="project_id" attrs="{'invisible': ['|', ('action_type', '!=', 'budget_overview_report'), ('report_type', 'not in', ('project_base'))]}"/>
                            <!-- filter invest_construction -->
                            <field name="invest_construction_id" attrs="{'invisible': ['|', ('action_type', '!=', 'budget_overview_report'), ('report_type', 'not in', ('invest_construction'))]}"/>

                            # For menu my budget report
                            <field name="section_ids" widget="many2many_tags" attrs="{'invisible': ['|', ('action_type', '!=', 'my_budget_report'), ('report_type', 'not in', ('unit_base'))]}"/>
                            <field name="project_ids" widget="many2many_tags" attrs="{'invisible': ['|', ('action_type', '!=', 'my_budget_report'), ('report_type', 'not in', ('project_base'))]}"/>

                            <!-- filter chart view -->
                            <field name="chartfield_ids" widget="many2many_tags" invisible="1"/>
                        </group>
                        <group>
                            <field name="group_by_chartfield_id" attrs="{'invisible': ['|', ('action_type', '!=', 'budget_overview_report'), ('report_type', 'not in', ('all'))]}"/>
                            <field name="group_by_org_id" attrs="{'invisible': ['|', ('action_type', '!=', 'budget_overview_report'), ('report_type', 'not in', ('invest_asset', 'invest_construction', 'personnel'))]}"/>
                            <field name="group_by_section_id"  attrs="{'invisible': [('report_type', 'not in', ('unit_base'))]}"/>
                            <field name="group_by_invest_construction_id" attrs="{'invisible': ['|', ('action_type', '!=', 'budget_overview_report'), ('report_type', 'not in', ('invest_construction'))]}"/>
                            <field name="group_by_invest_construction_phase_id" attrs="{'invisible': ['|', ('action_type', '!=', 'budget_overview_report'), ('report_type', 'not in', ('invest_construction'))]}"/>
                            <field name="group_by_project_id" attrs="{'invisible': [('report_type', 'not in', ('project_base'))]}"/>
                            <field name="group_by_charge_type" attrs="{'invisible': [('report_type', 'not in', ('unit_base', 'project_base'))]}"/>
                            <field name="group_by_personnel_costcenter_id" attrs="{'invisible': ['|', ('action_type', '!=', 'budget_overview_report'), ('report_type', 'not in', ('personnel'))]}"/>
                            <field name="group_by_activity_group_id" attrs="{'invisible': [('report_type', 'not in', ('unit_base', 'project_base', 'personnel'))]}"/>
                            <field name="group_by_activity_id" attrs="{'invisible': [('report_type', 'not in', ('unit_base', 'project_base', 'personnel'))]}"/>
                            <field name="group_by_invest_asset_id" attrs="{'invisible': ['|', ('action_type', '!=', 'budget_overview_report'), ('report_type', 'not in', ('invest_asset'))]}"/>
                        </group>
                    </group>
                </form>
            </field>
        </record>
        
        <record model="ir.ui.view" id="view_budget_common_show_uuid_form">
            <field name="name">view.budget.common.show.uuid.form</field>
            <field name="model">report.budget.common.multi</field>
            <field name="arch" type="xml">
                <form string="Report Enqueued" edit="0" create="0" delete="0">
                	<group name="Report Enqueued" string="Report Enqueued (.xlsx)">
                		<field name="uuid" readonly="1"/>
                	</group>
                	<footer>
                		<button string="close" class="oe_button" special="cancel"/>
                	</footer>
                </form>
            </field>
        </record>
	</data>
</openerp>